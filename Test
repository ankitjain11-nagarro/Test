SnsClient snsClient = SnsClient.create();
public void publishToSns(String topicArn, String message, Map<String, String> messageAttributes) {
    Map<String, MessageAttributeValue> attributes = messageAttributes.entrySet().stream()
        .collect(Collectors.toMap(
            Map.Entry::getKey,
            entry -> MessageAttributeValue.builder()
                    .dataType("String")
                    .stringValue(entry.getValue())
                    .build()
        ));

    PublishRequest request = PublishRequest.builder()
        .topicArn(topicArn)
        .message(message)
        .messageAttributes(attributes) // Optional: for filtering
        .build();

    snsClient.publish(request);
}
